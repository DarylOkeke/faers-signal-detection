anyio==4.9.0
appnope==0.1.4
argon2-cffi==23.1.0
argon2-cffi-bindings==21.2.0
arrow==1.3.0
asttokens==3.0.0
async-lru==2.0.5
attrs==25.3.0
babel==2.17.0
beautifulsoup4==4.13.4
bleach==6.2.0
certifi==2025.4.26
cffi==1.17.1
charset-normalizer==3.4.2
comm==0.2.2
debugpy==1.8.14
decorator==5.2.1
defusedxml==0.7.1
executing==2.2.0
fastjsonschema==2.21.1
fqdn==1.5.1
h11==0.16.0
httpcore==1.0.9
httpx==0.28.1
idna==3.10
ipykernel==6.29.5
ipython==9.3.0
ipython_pygments_lexers==1.1.1
isoduration==20.11.0
jedi==0.19.2
Jinja2==3.1.6
json5==0.12.0
jsonpointer==3.0.0
jsonschema==4.24.0
jsonschema-specifications==2025.4.1
jupyter-events==0.12.0
jupyter-lsp==2.2.5
jupyter_client==8.6.3
jupyter_core==5.8.1
jupyter_server==2.16.0
jupyter_server_terminals==0.5.3
jupyterlab==4.4.3
jupyterlab_pygments==0.3.0
jupyterlab_server==2.27.3
lxml==6.0.0
MarkupSafe==3.0.2
matplotlib-inline==0.1.7
mistune==3.1.3
nbclient==0.10.2
nbconvert==7.16.6
nbformat==5.10.4
nest-asyncio==1.6.0
notebook==7.4.3
notebook_shim==0.2.4
overrides==7.7.0
packaging==25.0
pandocfilters==1.5.1
parso==0.8.4
pexpect==4.9.0
platformdirs==4.3.8
prometheus_client==0.22.0
prompt_toolkit==3.0.51
psutil==7.0.0
ptyprocess==0.7.0
pure_eval==0.2.3
pycparser==2.22
Pygments==2.19.1
python-dateutil==2.9.0.post0
python-json-logger==3.3.0
PyYAML==6.0.2
pyzmq==26.4.0
referencing==0.36.2
requests==2.32.3
rfc3339-validator==0.1.4
rfc3986-validator==0.1.1
rpds-py==0.25.1
Send2Trash==1.8.3
setuptools==80.9.0
six==1.17.0
sniffio==1.3.1
soupsieve==2.7
stack-data==0.6.3
terminado==0.18.1
tinycss2==1.4.0
tornado==6.5.1
traitlets==5.14.3
types-python-dateutil==2.9.0.20250516
typing_extensions==4.13.2
uri-template==1.3.0
urllib3==2.4.0
wcwidth==0.2.13
webcolors==24.11.1
webencodings==0.5.1
websocket-client==1.8.0








{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "19484034",
   "metadata": {},
   "source": [
    "# Setting up SQLite environment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "12927307",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "import pandas as pd\n",
    "import sqlite3\n",
    "import os\n",
    "\n",
    "# 1. Configuration – adjust QUARTERS if you only want one\n",
    "DATA_DIR = '../data'\n",
    "QUARTERS = ['24Q4', '25Q1']      # or ['25Q1'] to just load Q1 2025\n",
    "TABLES = ['DEMO', 'DRUG', 'REAC']\n",
    "DB_PATH = os.path.join(DATA_DIR, 'faers.db')\n",
    "\n",
    "# 2. Connect to your SQLite DB\n",
    "conn = sqlite3.connect(DB_PATH)\n",
    "\n",
    "# 3. Loop through quarters and tables\n",
    "for quarter in QUARTERS:\n",
    "    year = 2000 + int(quarter[:2])        # e.g. 2000+24 = 2024\n",
    "    period = quarter[2:]                  # 'Q4' or 'Q1'\n",
    "    folder = f\"FAERS{period}_{year}\"      # e.g. 'FAERSQ4_2024'\n",
    "    \n",
    "    for tbl in TABLES:\n",
    "        path = os.path.join(DATA_DIR, folder, 'ASCII', f\"{tbl}{quarter}.txt\")\n",
    "        \n",
    "        # 4. Read the raw file into pandas\n",
    "        df = pd.read_csv(\n",
    "            path,\n",
    "            sep='$',\n",
    "            encoding='latin-1',\n",
    "            dtype=str,\n",
    "            low_memory=False\n",
    "        )\n",
    "        \n",
    "        # 5. Tag rows with their quarter\n",
    "        df['quarter'] = quarter\n",
    "        \n",
    "        # 6. Write to SQLite\n",
    "        table_name = f\"{tbl.lower()}{quarter.lower()}\" \n",
    "        df.to_sql(table_name, conn, if_exists='replace', index=False)\n",
    "        \n",
    "        #print(f\"Loaded {table_name}: {df.shape[0]} rows\")\n",
    "conn.close()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c0a70a03",
   "metadata": {
    "vscode": {
     "languageId": "julia"
    }
   },
   "source": [
    "| Data Type  | Column name     | Description                                                        |\n",
    "|---------|--------------|--------------------------------------------------------------------|\n",
    "| DEMO    | primaryid     | Unique ID for a single report                                     |\n",
    "| DEMO    | caseid        | Case identifier (can be shared across multiple reports)            |\n",
    "| DEMO    | age           | Patient age                                                       |\n",
    "| DEMO    | age_cod       | Units for age (e.g., YR, MON, DY)                                 |\n",
    "| DEMO    | age_grp       | Age group (e.g., A, C)                                            |\n",
    "| DEMO    | sex           | Gender (M, F, U)                                                  |\n",
    "| DEMO    | wt            | Weight                                                            |\n",
    "| DEMO    | wt_cod        | Units for weight (e.g., KG, LB)                                   |\n",
    "| DEMO    | rept_dt       | Date the report was filed                                         |\n",
    "| DEMO    | occr_country  | Country where the reaction occurred                               |\n",
    "| DRUG    | primaryid     | Links to DEMO and REAC                                            |\n",
    "| DRUG    | drugname      | Name of the drug reported                                         |\n",
    "| DRUG    | role_cod      | Role of the drug (PS = primary suspect, SS = secondary suspect)   |\n",
    "| DRUG    | route         | Route of administration (oral, intravenous, etc.)                 |\n",
    "| DRUG    | dose_vbm      | Dose given                                                        |\n",
    "| DRUG    | drug_seq      | Sequence of drug in multi-drug report                             |\n",
    "| REAC    | primaryid     | Links to DEMO and REAC                                            |\n",
    "| REAC    | pt            | Preferred Term – the actual adverse event (e.g., nausea, death)   |\n",
    "| REAC    | outc_cod      | Outcome code (e.g., death, hospitalization)                       |"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "38d00090",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>total_reports_24q4</th>\n",
       "      <th>total_reports_25q1</th>\n",
       "      <th>total_demo_24q4</th>\n",
       "      <th>total_demo_25q</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1472750</td>\n",
       "      <td>1432926</td>\n",
       "      <td>410849</td>\n",
       "      <td>400514</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   total_reports_24q4  total_reports_25q1  total_demo_24q4  total_demo_25q\n",
       "0             1472750             1432926           410849          400514"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 7. Check data query, then test it\n",
    "conn = sqlite3.connect(DB_PATH)\n",
    "def sql(query):\n",
    "    return pd.read_sql_query(query, conn)\n",
    "\n",
    "sql(\"\"\"\n",
    "SELECT\n",
    "    (SELECT COUNT(primaryid) FROM reac24q4) AS total_reports_24q4,\n",
    "    (SELECT COUNT(primaryid) FROM reac25q1) AS total_reports_25q1,\n",
    "    (SELECT COUNT(primaryid) FROM demo24q4) AS total_demo_24q4,\n",
    "    (SELECT COUNT(primaryid) FROM demo25q1) AS total_demo_25q\n",
    "\"\"\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ca21eaca",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f92f9647",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "c15c62a7",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "352dd414",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
